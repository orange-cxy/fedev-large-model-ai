!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&n(e)}).observe(document,{childList:!0,subtree:!0})}function n(e){if(e.ep)return;e.ep=!0;const n=function(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?n.credentials="include":"anonymous"===e.crossOrigin?n.credentials="omit":n.credentials="same-origin",n}(e);fetch(e.href,n)}}();const e=[{id:"deepseek",name:"Deepseek",endpoint:"https://api.deepseek.com/chat/completions",apiKeyEnv:"VITE_DEEPSEEK_API_KEY",defaultKey:"demo_key",model:"deepseek-chat",mockEndpoint:"http://localhost:3001/api/mock-deepseek",formatPayload:(e,n={})=>({model:"deepseek-chat",messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:e}],stream:n.stream||!1})},{id:"coze",name:"Coze",endpoint:"https://api.coze.cn/v3/chat",apiKeyEnv:"VITE_COZE_API_KEY",defaultKey:"demo_key",model:"coze-chat",mockEndpoint:"http://localhost:3001/api/mock-coze",formatPayload:(e,n={})=>({bot_id:void 0,user_id:void 0,stream:n.stream||!1,additional_messages:[{content:e,content_type:"text",role:"user",type:"question"}],parameters:{}})}];function n(e,n,t={}){return e.formatPayload&&"function"==typeof e.formatPayload?e.formatPayload(n,t):{model:e.model,messages:n,stream:t.stream||!1}}function t(){return e[0]}function o(){const n=localStorage.getItem("selected_model");return n?(o=n,e.find(e=>e.id===o)||t()):t();var o}var r={};var c=null;try{(function(e,n,t){let o=Promise.resolve();if(n&&n.length>0){const e=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),a=s?.nonce||s?.getAttribute("nonce");c=n.map(n=>{if((n=function(e){return"/fedev-large-model-ai/"+e}(n))in r)return;r[n]=!0;const o=n.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(t)for(let t=e.length-1;t>=0;t--){const r=e[t];if(r.href===n&&(!o||"stylesheet"===r.rel))return}else if(document.querySelector(`link[href="${n}"]${c}`))return;const s=document.createElement("link");return s.rel=o?"stylesheet":"modulepreload",o||(s.as="script"),s.crossOrigin="",s.href=n,a&&s.setAttribute("nonce",a),document.head.appendChild(s),o?new Promise((e,t)=>{s.addEventListener("load",e),s.addEventListener("error",()=>t(new Error(`Unable to preload CSS for ${n}`)))}):void 0}),o=Promise.all(c.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))}var c;function s(e){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=e,window.dispatchEvent(n),!n.defaultPrevented)throw e}return o.then(n=>{for(const e of n||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})})(()=>import("./mode-config-CuatFriw.js"),[]).then(e=>{c=e.default||e,console.log("导入的模式配置:",c)}).catch(e=>{console.log("未找到模式配置文件，使用默认配置")})}catch(u){console.log("导入模式配置出错:",u)}document.getElementById("app").innerHTML='\n  <div class="container">\n    <h1>AI 对话助手</h1>\n    <div class="model-selector">\n      <label for="model-select">选择模型：</label>\n      <select id="model-select"></select>\n    </div>\n    <div class="mode-switcher">\n      <button id="btn-mock" class="mode-btn active">Mock模式</button>\n      <button id="btn-real" class="mode-btn">真实模式</button>\n    </div>\n    <div id="current-status" class="status-info">当前状态: Mock | Deepseek</div>\n    <div id="reply" class="reply">thinking...</div>\n    <button id="refresh-btn" class="refresh-btn">刷新响应</button>\n  </div>\n';var s=document.createElement("style");function a(){try{const e=localStorage.getItem("app_mode");if("mock"===e||"real"===e){const n="mock"===e;return console.log("LocalStorage模式: "+(n?"mock":"真实")),n}const n=new URLSearchParams(window.location.search).get("mock");if(null!==n){const e="true"===n;return console.log("URL参数模式: "+(e?"mock":"真实")),e}if(c&&c.app_mode){const e="mock"===c.app_mode;return console.log("配置文件模式: "+(e?"mock":"真实")),e}return console.log("默认模式: mock"),!0}catch(u){return console.error("检查mock模式出错:",u),!0}}function l(e){localStorage.setItem("app_mode",e?"mock":"real"),document.getElementById("btn-mock").classList.toggle("active",e),document.getElementById("btn-real").classList.toggle("active",!e),i(e),console.log("模式已切换为: "+(e?"mock":"real"))}function i(e=null){const n=null!==e?e:a(),t=o();document.getElementById("current-status").textContent=`当前状态: ${n?"Mock":"真实"} | ${t.name}`}function d(){const n=document.getElementById("model-select"),t=o();e.forEach(e=>{const o=document.createElement("option");o.value=e.id,o.textContent=e.name,o.selected=e.id===t.id,n.appendChild(o)}),n.addEventListener("change",e=>{const n=e.target.value;var t;t=n,localStorage.setItem("selected_model",t),i(),m()})}async function m(){const e=document.getElementById("reply");e.textContent="thinking...",i();try{const t=await async function(){const e=a(),t=o();console.log(`当前模型: ${t.name}, 模式: ${e?"Mock":"真实"}`);try{let o;const r=`你好 ${t.name}`;if(e){console.log(`使用${t.name}的Mock API`);const e=n(t,r,{isMock:!0});o=await fetch(t.mockEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}else{console.log(`使用${t.name}的真实API`);const e={"Content-Type":"application/json",Authorization:`Bearer ${{BASE_URL:"/fedev-large-model-ai/",DEV:!1,MODE:"production",PROD:!0,SSR:!1}[t.apiKeyEnv]||t.defaultKey}`},c=n(t,r,{stream:!1});console.log(`发送到${t.name}的请求格式:`,JSON.stringify(c,null,2)),o=await fetch(t.endpoint,{method:"POST",headers:e,body:JSON.stringify(c)})}if(!o.ok)throw new Error(`${e?"模拟":"真实"}API错误: ${o.status}`);return(await o.json()).choices[0].message.content}catch(r){return console.error(`${e?"获取模拟":"获取真实"}${t.name}响应失败:`,r),`⚫ 这是一条${e?"模拟":"测试"}响应数据（${t.name}）${e?"，用于验证Mock模式功能。":"，用于验证保存功能。"}`}}();e.textContent=t,a()||t.startsWith("⚫")||await async function(e){if(a())return void console.log("Mock模式下，不保存响应到文件");const n=o(),t={timestamp:(new Date).toISOString(),model:n.id,modelName:n.name,response:e,request:{model:n.model,messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:`你好 ${n.name}`}]}};try{const e=await(await fetch("http://localhost:3001/api/save-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();e.success?console.log(e.message):console.error("保存失败:",e.message)}catch(r){console.error("保存文件时发生错误:",r)}}(t)}catch(t){console.error("获取响应失败:",t),e.textContent=`获取响应失败: ${t.message}`}}s.textContent="\n  body {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    min-height: 100vh;\n    margin: 0;\n    background-color: #f0f7ff;\n  }\n  .container {\n    text-align: center;\n    padding: 2rem;\n    background-color: white;\n    border-radius: 12px;\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n  }\n  h1 {\n    color: #3498db;\n    margin-bottom: 1.5rem;\n  }\n  .reply {\n    padding: 1rem;\n    background-color: #f8f9fa;\n    border-radius: 8px;\n    border-left: 4px solid #3498db;\n    min-height: 60px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1.1rem;\n    margin-bottom: 1rem;\n  }\n  .model-selector {\n    margin-bottom: 1rem;\n  }\n  .model-selector select {\n    padding: 0.5rem;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    font-size: 1rem;\n  }\n  .status-info {\n    margin-bottom: 1rem;\n    font-size: 0.9rem;\n    color: #666;\n  }\n  .mode-switcher {\n    display: flex;\n    justify-content: center;\n    gap: 0.5rem;\n    margin-bottom: 1rem;\n  }\n  .mode-btn {\n    padding: 0.5rem 1rem;\n    border: 1px solid #ddd;\n    background-color: #f8f9fa;\n    border-radius: 4px;\n    cursor: pointer;\n  }\n  .mode-btn.active {\n    background-color: #3498db;\n    color: white;\n    border-color: #3498db;\n  }\n  .refresh-btn {\n    padding: 0.5rem 1.5rem;\n    background-color: #2ecc71;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1rem;\n  }\n  .refresh-btn:hover {\n    background-color: #27ae60;\n  }\n",document.head.appendChild(s),function(){const e=document.getElementById("btn-mock"),n=document.getElementById("btn-real"),t=document.getElementById("refresh-btn");d(),l(a()),e.addEventListener("click",()=>{l(!0),m()}),n.addEventListener("click",()=>{l(!1),m()}),t.addEventListener("click",()=>{m()})}(),m();
//# sourceMappingURL=index-CkVRJs6n.js.map
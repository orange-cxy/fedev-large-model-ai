!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const e=[{id:"deepseek",name:"Deepseek",endpoint:"https://api.deepseek.com/chat/completions",apiKeyEnv:"VITE_DEEPSEEK_API_KEY",defaultKey:"demo_key",model:"deepseek-chat",mockEndpoint:"http://localhost:3001/api/mock-api",formatPayload:(e,t={})=>({model:"deepseek-chat",modelId:"deepseek",messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:e}],stream:t.stream||!1}),formatResponse:e=>({context:e.choices[0].message.content})},{id:"cozeV3",name:"CozeV3",endpoint:"https://api.coze.cn/v3/chat",apiKeyEnv:"VITE_COZE_API_KEY",defaultKey:"demo_key",model:"coze-chat",mockEndpoint:"http://localhost:3001/api/mock-api",formatPayload:(e,t={})=>({modelId:"cozeV3",bot_id:void 0,user_id:void 0,stream:!1,query:"你好",chat_history:[],custom_variables:{prompt:e}}),formatResponse:e=>({context:e.msg})},{id:"cozeV2",name:"CozeV2",endpoint:"https://api.coze.cn/open_api/v2/chat",apiKeyEnv:"VITE_COZE_API_KEY",defaultKey:"demo_key",model:"coze-chat",mockEndpoint:"http://localhost:3001/api/mock-api",formatPayload:(e,t={})=>({modelId:"cozeV2",bot_id:void 0,user:void 0,query:e,chat_history:[],stream:!1,custom_variables:{prompt:e}}),formatResponse:e=>({context:e.messages[0].content})},{id:"kimi-k2-0905-preview",name:"kimi-k2-0905-preview",endpoint:"https://api.moonshot.cn/v1/chat/completions",apiKeyEnv:"VITE_MOONSHOT_API_KEY",defaultKey:"demo_key",model:"coze-chat",mockEndpoint:"http://localhost:3001/api/mock-api",formatPayload:(e,t={})=>({model:"kimi-k2-0905-preview",messages:[{role:"system",content:e}],temperature:.3,max_tokens:8192,top_p:1,stream:!1}),formatResponse:e=>({context:e.choices[0].message.content})}];function t(e,t,n={}){return e.formatPayload&&"function"==typeof e.formatPayload?e.formatPayload(t,n):{model:e.model,messages:t,choices:{messages:t},stream:n.stream||!1}}function n(){return e[0]}function o(){const t=localStorage.getItem("selected_model");return t?(o=t,e.find(e=>e.id===o)||n()):n();var o}var r={};var a=null;try{(function(e,t,n){let o=Promise.resolve();if(t&&t.length>0){const e=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),s=c?.nonce||c?.getAttribute("nonce");a=t.map(t=>{if((t=function(e){return"/fedev-large-model-ai/"+e}(t))in r)return;r[t]=!0;const o=t.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(n)for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.href===t&&(!o||"stylesheet"===r.rel))return}else if(document.querySelector(`link[href="${t}"]${a}`))return;const c=document.createElement("link");return c.rel=o?"stylesheet":"modulepreload",o||(c.as="script"),c.crossOrigin="",c.href=t,s&&c.setAttribute("nonce",s),document.head.appendChild(c),o?new Promise((e,n)=>{c.addEventListener("load",e),c.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${t}`)))}):void 0}),o=Promise.all(a.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))}var a;function c(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return o.then(t=>{for(const e of t||[])"rejected"===e.status&&c(e.reason);return e().catch(c)})})(()=>import("./mode-config-CuatFriw.js"),[]).then(e=>{a=e.default||e,console.log("导入的模式配置:",a)}).catch(e=>{console.log("未找到模式配置文件，使用默认配置")})}catch(p){console.log("导入模式配置出错:",p)}document.getElementById("app").innerHTML='\n  <div class="container">\n    <h1>AI 对话助手</h1>\n    <div class="model-selector">\n      <label for="model-select">选择模型：</label>\n      <select id="model-select"></select>\n    </div>\n    <div class="mode-switcher">\n      <button id="btn-mock" class="mode-btn active">Mock模式</button>\n      <button id="btn-real" class="mode-btn">真实模式</button>\n    </div>\n    <div id="current-status" class="status-info">当前状态: Mock | Deepseek</div>\n    <div id="reply" class="reply">thinking...</div>\n    <button id="refresh-btn" class="refresh-btn">刷新响应</button>\n  </div>\n';var c=document.createElement("style");function s(){try{const e=localStorage.getItem("app_mode");if("mock"===e||"real"===e){const t="mock"===e;return console.log("LocalStorage模式: "+(t?"mock":"真实")),t}const t=new URLSearchParams(window.location.search).get("mock");if(null!==t){const e="true"===t;return console.log("URL参数模式: "+(e?"mock":"真实")),e}if(a&&a.app_mode){const e="mock"===a.app_mode;return console.log("配置文件模式: "+(e?"mock":"真实")),e}return console.log("默认模式: mock"),!0}catch(p){return console.error("检查mock模式出错:",p),!0}}function i(e){localStorage.setItem("app_mode",e?"mock":"real"),document.getElementById("btn-mock").classList.toggle("active",e),document.getElementById("btn-real").classList.toggle("active",!e),l(e),console.log("模式已切换为: "+(e?"mock":"real"))}function l(e=null){const t=null!==e?e:s(),n=o();document.getElementById("current-status").textContent=`当前状态: ${t?"Mock":"真实"} | ${n.name}`}function d(){const t=document.getElementById("model-select"),n=o();e.forEach(e=>{const o=document.createElement("option");o.value=e.id,o.textContent=e.name,o.selected=e.id===n.id,t.appendChild(o)}),t.addEventListener("change",e=>{const t=e.target.value;var n;n=t,localStorage.setItem("selected_model",n),l(),m()})}async function m(){const e=document.getElementById("reply");e.textContent="thinking...",l();try{const n=await async function(){const e=s(),n=o();console.log(`当前模型: ${n.name}, 模式: ${e?"Mock":"真实"}`);try{let o;const r=`你好 ${n.name}`;if(e){console.log(`使用${n.name}的Mock API`);const e=t(n,r,{isMock:!0});o=await fetch(n.mockEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}else{console.log(`使用${n.name}的真实API`,n.apiKeyEnv,{BASE_URL:"/fedev-large-model-ai/",DEV:!1,MODE:"production",PROD:!0,SSR:!1});const e={"Content-Type":"application/json",Authorization:`Bearer ${{BASE_URL:"/fedev-large-model-ai/",DEV:!1,MODE:"production",PROD:!0,SSR:!1}[n.apiKeyEnv]||n.defaultKey}`},a=t(n,r,{stream:!1});console.log(`发送到${n.name}的请求格式:`,JSON.stringify(a,null,2)),o=await fetch(n.endpoint,{method:"POST",headers:e,body:JSON.stringify(a)})}if(!o.ok)throw new Error(`${e?"模拟":"真实"}API错误: ${o.status}`);const a=await o.json(),c=function(e,t){return e.formatResponse&&"function"==typeof e.formatResponse?e.formatResponse(t):{context:""}}(n,a);return{response:a,data:c}}catch(r){return console.error(`${e?"获取模拟":"获取真实"}${n.name}响应失败:`,r),{response:null,data:{context:`⚫ 这是一条${e?"模拟":"测试"}响应数据（${n.name}）${e?"，用于验证Mock模式功能。":"，用于验证保存功能。"}`}}}}();e.textContent=n.data.context,s()||n.data.context.startsWith("⚫")||await async function(e){if(s())return void console.log("Mock模式下，不保存响应到文件");const t=o(),n={timestamp:(new Date).toISOString(),model:t.id,modelName:t.name,response:e,request:t.formatPayload(`你好 ${t.name}`)};try{const e=await(await fetch("http://localhost:3001/api/save-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();e.success?console.log(e.message):console.error("保存失败:",e.message)}catch(r){console.error("保存文件时发生错误:",r)}}(n.response)}catch(n){console.error("获取响应失败:",n),e.textContent=`获取响应失败: ${n.message}`}}c.textContent="\n  body {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    min-height: 100vh;\n    margin: 0;\n    background-color: #f0f7ff;\n  }\n  .container {\n    text-align: center;\n    padding: 2rem;\n    background-color: white;\n    border-radius: 12px;\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n  }\n  h1 {\n    color: #3498db;\n    margin-bottom: 1.5rem;\n  }\n  .reply {\n    padding: 1rem;\n    background-color: #f8f9fa;\n    border-radius: 8px;\n    border-left: 4px solid #3498db;\n    min-height: 60px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1.1rem;\n    margin-bottom: 1rem;\n  }\n  .model-selector {\n    margin-bottom: 1rem;\n  }\n  .model-selector select {\n    padding: 0.5rem;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    font-size: 1rem;\n  }\n  .status-info {\n    margin-bottom: 1rem;\n    font-size: 0.9rem;\n    color: #666;\n  }\n  .mode-switcher {\n    display: flex;\n    justify-content: center;\n    gap: 0.5rem;\n    margin-bottom: 1rem;\n  }\n  .mode-btn {\n    padding: 0.5rem 1rem;\n    border: 1px solid #ddd;\n    background-color: #f8f9fa;\n    border-radius: 4px;\n    cursor: pointer;\n  }\n  .mode-btn.active {\n    background-color: #3498db;\n    color: white;\n    border-color: #3498db;\n  }\n  .refresh-btn {\n    padding: 0.5rem 1.5rem;\n    background-color: #2ecc71;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1rem;\n  }\n  .refresh-btn:hover {\n    background-color: #27ae60;\n  }\n",document.head.appendChild(c),function(){const e=document.getElementById("btn-mock"),t=document.getElementById("btn-real"),n=document.getElementById("refresh-btn");d(),i(s()),e.addEventListener("click",()=>{i(!0),m()}),t.addEventListener("click",()=>{i(!1),m()}),n.addEventListener("click",()=>{m()})}(),m();
//# sourceMappingURL=index-DNJrztiF.js.map
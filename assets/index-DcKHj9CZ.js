!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&n(e)}).observe(document,{childList:!0,subtree:!0})}function n(e){if(e.ep)return;e.ep=!0;const n=function(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?n.credentials="include":"anonymous"===e.crossOrigin?n.credentials="omit":n.credentials="same-origin",n}(e);fetch(e.href,n)}}();var e=(e,n,t)=>{const o=n.lastIndexOf("?"),r=e[-1===o||o<n.lastIndexOf("/")?n:n.slice(0,o)];return r?"function"==typeof r?r():Promise.resolve(r):new Promise((e,o)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+n+(n.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})},n={};const t=function(e,t,o){let r=Promise.resolve();if(t&&t.length>0){const e=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),i=a?.nonce||a?.getAttribute("nonce");s=t.map(t=>{if((t=function(e){return"/fedev-large-model-ai/"+e}(t))in n)return;n[t]=!0;const r=t.endsWith(".css"),s=r?'[rel="stylesheet"]':"";if(o)for(let n=e.length-1;n>=0;n--){const o=e[n];if(o.href===t&&(!r||"stylesheet"===o.rel))return}else if(document.querySelector(`link[href="${t}"]${s}`))return;const a=document.createElement("link");return a.rel=r?"stylesheet":"modulepreload",r||(a.as="script"),a.crossOrigin="",a.href=t,i&&a.setAttribute("nonce",i),document.head.appendChild(a),r?new Promise((e,n)=>{a.addEventListener("load",e),a.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${t}`)))}):void 0}),r=Promise.all(s.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))}var s;function a(e){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=e,window.dispatchEvent(n),!n.defaultPrevented)throw e}return r.then(n=>{for(const e of n||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})};var o=["deepseek","cozeV3","cozeV2","kimi-k2-0905-preview"].map(n=>({id:n,json:()=>e({"./models/cozeV2.json":()=>t(()=>import("./cozeV2-D5Ngzbx2.js"),[]),"./models/cozeV3.json":()=>t(()=>import("./cozeV3-Du_tU4-F.js"),[]),"./models/deepseek.json":()=>t(()=>import("./deepseek-BathJCgQ.js"),[]),"./models/kimi-k2-0905-preview.json":()=>t(()=>import("./kimi-k2-0905-preview-C0-6Eb9c.js"),[])},`./models/${n}.json`,3),js:()=>e({"./models/cozeV2.js":()=>t(()=>import("./cozeV2-CSqoTWVc.js"),[]),"./models/cozeV3.js":()=>t(()=>import("./cozeV3-DD83FSWK.js"),[]),"./models/deepseek.js":()=>t(()=>import("./deepseek-BD3r4UzN.js"),[]),"./models/kimi-k2-0905-preview.js":()=>t(()=>import("./kimi-k2-0905-preview-BSeymYnA.js"),[])},`./models/${n}.js`,3)})),r=["kimi-k2-0711-preview","kimi-k2-0905-preview","kimi-k2-turbo-preview","kimi-latest","kimi-thinking-preview","moonshot-v1-128k","moonshot-v1-128k-vision-preview","moonshot-v1-32k","moonshot-v1-32k-vision-preview","moonshot-v1-8k","moonshot-v1-8k-vision-preview","moonshot-v1-auto"].map(e=>({id:e,json:()=>t(()=>import("./kimi-k2-0905-preview-C0-6Eb9c.js"),[]),js:()=>t(()=>import("./kimi-k2-0905-preview-BSeymYnA.js"),[]),options:{id:e,name:e,model:e}}));o=o.concat(r);var s=[];function a(){return s[0]}function i(){const e=localStorage.getItem("selected_model");return console.log("savedModelId: ",e,s),e?(n=e,s.find(e=>e.id===n)||a()):a();var n}await async function(){0===(s=(await Promise.all(o.map(async e=>{try{const n=await e.json(),t=n.default||n,o=await e.js();return{...t,formatPayload:o.formatPayload,formatResponse:o.formatResponse,...e.options}}catch(n){return console.error(`Failed to load model ${e.id}:`,n),null}}))).filter(e=>null!==e)).length&&(s=[{id:"deepseek",name:"Deepseek",endpoint:"https://api.deepseek.com/chat/completions",apiKeyEnv:"VITE_DEEPSEEK_API_KEY",defaultKey:"demo_key",model:"deepseek-chat",mockEndpoint:"http://localhost:3001/api/mock-api",formatPayload:(e,n={})=>({model:"deepseek-chat",modelId:"deepseek",messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:e}],stream:n.stream||!1}),formatResponse:e=>({context:e.choices?.[0]?.message?.content||""})}])}().catch(e=>{console.error("Failed to initialize models:",e)});var c=null;try{t(()=>import("./mode-config-CuatFriw.js"),[]).then(e=>{c=e.default||e,console.log("导入的模式配置:",c)}).catch(e=>{console.log("未找到模式配置文件，使用默认配置")})}catch(y){console.log("导入模式配置出错:",y)}document.getElementById("app").innerHTML='\n  <div class="container">\n    <h1>AI 对话助手</h1>\n    <div class="model-selector">\n      <label for="model-select">选择模型：</label>\n      <select id="model-select"></select>\n    </div>\n    <div class="mode-switcher">\n      <button id="btn-mock" class="mode-btn active">Mock模式</button>\n      <button id="btn-real" class="mode-btn">真实模式</button>\n    </div>\n    <div id="current-status" class="status-info">当前状态: Mock | Deepseek</div>\n    \n    \x3c!-- 新增文本输入区域 --\x3e\n    <div class="input-area">\n      <textarea id="user-input" placeholder="请输入您的问题..."></textarea>\n      <button id="send-btn" class="send-btn">发送</button>\n    </div>\n    \n    \x3c!-- 响应显示区域 --\x3e\n    <div class="response-area">\n      <h3>AI回复：</h3>\n      <div id="reply" class="reply">请输入问题并发送</div>\n    </div>\n  </div>\n';var l=document.createElement("style");function d(){try{const e=localStorage.getItem("app_mode");if("mock"===e||"real"===e){const n="mock"===e;return console.log("LocalStorage模式: "+(n?"mock":"真实")),n}const n=new URLSearchParams(window.location.search).get("mock");if(null!==n){const e="true"===n;return console.log("URL参数模式: "+(e?"mock":"真实")),e}if(c&&c.app_mode){const e="mock"===c.app_mode;return console.log("配置文件模式: "+(e?"mock":"真实")),e}return console.log("默认模式: mock"),!0}catch(y){return console.error("检查mock模式出错:",y),!0}}function m(e){localStorage.setItem("app_mode",e?"mock":"real"),document.getElementById("btn-mock").classList.toggle("active",e),document.getElementById("btn-real").classList.toggle("active",!e),p(e),console.log("模式已切换为: "+(e?"mock":"real"))}function p(e=null){const n=null!==e?e:d(),t=i();document.getElementById("current-status").textContent=`当前状态: ${n?"Mock":"真实"} | ${t.name}`}function u(){const e=document.getElementById("model-select"),n=i();s.forEach(t=>{const o=document.createElement("option");o.value=t.id,o.textContent=t.name,o.selected=t.id===n.id,e.appendChild(o)}),e.addEventListener("change",e=>{const n=e.target.value;var t;t=n,localStorage.setItem("selected_model",t),p(),h()})}async function f(){const e=document.getElementById("user-input").value.trim();if(!e)return void alert("请输入问题");const n=document.getElementById("send-btn");n.disabled=!0;try{await h(e)}finally{n.disabled=!1}}async function g(e,n){const t=d(),o=i();console.log(`当前模型: ${o.name}, 模式: ${t?"Mock":"真实"}`);try{let r;const s=function(e,n,t={}){const o=void 0===t.stream||t.stream;return e.formatPayload&&"function"==typeof e.formatPayload?e.formatPayload(n,{...t,stream:o}):{model:e.model,messages:n,stream:o}}(o,e,{stream:!0,isMock:t});if(t)console.log(`使用${o.name}的Mock API`,JSON.stringify(s,null,2)),r=await fetch(o.mockEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s.model?s:{...s,model:o.id})});else{console.log(`使用${o.name}的真实API`);const e={"Content-Type":"application/json",Authorization:`Bearer ${{BASE_URL:"/fedev-large-model-ai/",DEV:!1,MODE:"production",PROD:!0,SSR:!1}[o.apiKeyEnv]||o.defaultKey}`};console.log(`发送到${o.name}的请求格式:`,JSON.stringify(s,null,2)),r=await fetch(o.endpoint,{method:"POST",headers:e,body:JSON.stringify(s.model?s:{...s,model:o.id})})}if(!r.ok)throw new Error(`${t?"模拟":"真实"}API错误: ${r.status}`);if(console.log("payload.stream && onStreamChunk",s.stream,n,r),s.stream&&n){let e="";return await async function(e,n){if(!e.body)throw new Error("Response body is not available");const t=e.body.getReader(),o=new TextDecoder;let r="";try{for(;;){const{done:e,value:a}=await t.read();if(e)break;const i=(r+o.decode(a,{stream:!0})).split("\n");r=i.pop();for(const t of i)if(t.startsWith("data: ")){const e=t.slice(6);if("[DONE]"===e)break;try{const t=JSON.parse(e);"function"==typeof n&&n(t)}catch(s){console.error("Failed to parse JSON:",s,"Line:",e)}}}}finally{t.releaseLock()}}(r,t=>{const r=function(e,n){return console.log("chunk: ",n,e.parseStreamChunk),e.parseStreamChunk&&"function"==typeof e.parseStreamChunk?e.parseStreamChunk(n):n.choices&&n.choices[0]&&n.choices[0].delta&&n.choices[0].delta.content||""}(o,t);e+=r,n(r,t)}),{response:e,data:{context:e}}}{const e=await r.json(),n=function(e,n){return e.formatResponse&&"function"==typeof e.formatResponse?e.formatResponse(n):{context:""}}(o,e);return{response:e,data:n}}}catch(r){return console.error(`${t?"获取模拟":"获取真实"}${o.name}响应失败:`,r),{response:null,data:{context:`⚫ 这是一条${t?"模拟":"测试"}响应数据（${o.name}）\n\n错误信息: ${r.message}`}}}}async function h(e){const n=document.getElementById("reply");n.textContent="正在生成回复...",p();try{let t="",o=Date.now(),r=null;const s=g(e,(e,s)=>{e&&(t+=e,n.textContent=t,o=Date.now()),s&&(r=s)}),a=setInterval(()=>{Date.now()-o>3e4&&(n.textContent+="\n\n⚠️ 响应超时，可能已断开连接。",clearInterval(a))},1e3),c=await s;clearInterval(a),n.textContent=c.data.context,d()||c.data.context.startsWith("⚫")||await async function(e,n){if(d())return void console.log("Mock模式下，不保存响应到文件");const t=i(),o=t.formatPayload(n),r={timestamp:(new Date).toISOString(),model:t.id,modelName:t.name,response:e,request:o,message:n};try{const e=await(await fetch("http://localhost:3001/api/save-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();e.success?console.log(e.message):console.error("保存失败:",e.message)}catch(s){console.error("保存文件时发生错误:",s)}}(r||c.response,e)}catch(t){console.error("获取响应失败:",t),n.textContent=`获取响应失败: ${t.message}`}}l.textContent="\n  body {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    min-height: 100vh;\n    margin: 0;\n    background-color: #f0f7ff;\n  }\n  .container {\n    text-align: center;\n    padding: 2rem;\n    background-color: white;\n    border-radius: 12px;\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n  }\n  h1 {\n    color: #3498db;\n    margin-bottom: 1.5rem;\n  }\n  .reply {\n    padding: 1rem;\n    background-color: #f8f9fa;\n    border-radius: 8px;\n    border-left: 4px solid #3498db;\n    min-height: 60px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1.1rem;\n    margin-bottom: 1rem;\n  }\n  .model-selector {\n    margin-bottom: 1rem;\n  }\n  .model-selector select {\n    padding: 0.5rem;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    font-size: 1rem;\n  }\n  .status-info {\n    margin-bottom: 1rem;\n    font-size: 0.9rem;\n    color: #666;\n  }\n  .mode-switcher {\n    display: flex;\n    justify-content: center;\n    gap: 0.5rem;\n    margin-bottom: 1rem;\n  }\n  .mode-btn {\n    padding: 0.5rem 1rem;\n    border: 1px solid #ddd;\n    background-color: #f8f9fa;\n    border-radius: 4px;\n    cursor: pointer;\n  }\n  .mode-btn.active {\n    background-color: #3498db;\n    color: white;\n    border-color: #3498db;\n  }\n  .refresh-btn {\n    padding: 0.5rem 1.5rem;\n    background-color: #2ecc71;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1rem;\n  }\n  .refresh-btn:hover {\n    background-color: #27ae60;\n  }\n  \n  /* 新增输入区域样式 */\n  .input-area {\n    margin: 1rem 0;\n    display: flex;\n    gap: 0.5rem;\n  }\n  \n  #user-input {\n    flex: 1;\n    padding: 0.8rem;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    font-size: 1rem;\n    resize: vertical;\n    min-height: 60px;\n  }\n  \n  .send-btn {\n    padding: 0.8rem 1.5rem;\n    background-color: #3498db;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 1rem;\n    white-space: nowrap;\n  }\n  \n  .send-btn:hover {\n    background-color: #2980b9;\n  }\n  \n  .send-btn:disabled {\n    background-color: #95a5a6;\n    cursor: not-allowed;\n  }\n  \n  .response-area {\n    margin-top: 1rem;\n    text-align: left;\n  }\n  \n  .response-area h3 {\n    margin: 0 0 0.5rem 0;\n    color: #333;\n    font-size: 1.1rem;\n  }\n  \n  .reply {\n    padding: 1rem;\n    background-color: #f8f9fa;\n    border-radius: 8px;\n    border-left: 4px solid #3498db;\n    min-height: 60px;\n    line-height: 1.6;\n  }\n",document.head.appendChild(l),function(){const e=document.getElementById("btn-mock"),n=document.getElementById("btn-real");document.getElementById("refresh-btn"),u(),m(d()),e.addEventListener("click",()=>{m(!0)}),n.addEventListener("click",()=>{m(!1)});const t=document.getElementById("send-btn"),o=document.getElementById("user-input");t.addEventListener("click",()=>{f()}),o.addEventListener("keydown",e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),f())})}();
//# sourceMappingURL=index-DcKHj9CZ.js.map